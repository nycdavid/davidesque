<canvas id="line-chart"></canvas>

{{ $dataPartial := .Get "dataPartial" }}
{{ partial "data.{{$dataPartial}}.html" }}

<script defer>
  document.addEventListener("DOMContentLoaded", () => {
    const ctx = document.getElementById("line-chart");
    const x = window.lineChartData.map(el => el[0]);
    const y = window.lineChartData.map(el => el[1]);

    const ch = new Chart(ctx, {
      type: "line",
      data: {
        datasets: [{
          label: "Weight",
          data: x.map((date, i) => ({
            x: date,
            y: y[i]
          })),
          borderColor: "rgb(75, 192, 192)",
          tension: 0.3
        }]
      },
      options: {
        responsive: true,
        scales: {
          x: {
            type: "time",
            time: {
              unit: "day",
              displayFormats: {
                day: "MMM d, yyyy"
              },
              tooltipFormat: "MMM d, yyyy"
            }
          }
        }
      }
    });

    ch.setActiveElements([ {datasetIndex: 0, index: x.length-1} ])
    ch.tooltip.setActiveElements(
      [{ datasetIndex: 0, index: x.length-1 }],
      { x: 0, y: 0 }
    );
    ch.update();
  });
</script>
